import{F as m,c as f,j as e,M as g,I as x,m as i,r as h,a as u,B as y,d as I,S as C,L as w}from"./index-b4d424f9.js";import{T as v,L as N,H as F}from"./link-breadcrumb-a8136315.js";const S=({open:c,onCancel:r,callBack:o})=>{const[s]=m.useForm(),l=f(),t=()=>{s.validateFields().then(async n=>{try{const{data:a}=await l.addAgent(n);(a==null?void 0:a.status)===!0&&(o(),r(),i.success(a.message))}catch{i.error(data.message)}}).catch(n=>{i.error(data.message)})};return e("div",{children:e(g,{destroyOnClose:!0,closeIcon:!1,keyboard:!0,title:e("div",{className:"mt-2 mb-5 ",children:"新增代理商"}),open:c,onOk:s.submit,onCancel:r,className:"text-center",bodyStyle:{display:"flex",alignItems:"center",justifyContent:"center",height:"60px"},width:470,children:e(m,{form:s,preserve:!1,name:"basic",onFinish:t,initialValues:{remember:!0},autoComplete:"off",children:e(m.Item,{label:"代理商名稱",name:"name",rules:[{required:!0,message:"請輸入代理商名稱"}],colon:!1,children:e(x,{className:"w-50"})})})})})},E=({onGetAgentsData:c,agentId:r,agentName:o})=>{const[s]=m.useForm(),l=f(),[t,n]=h.useState(!1),a=()=>{n(!0)},b=()=>{n(!1)},A=()=>{s.validateFields().then(async p=>{const k={...p,id:r};try{const{data:d}=await l.editAgent(k);(d==null?void 0:d.status)===!0?(c(),b(),i.success(d.message)):i.error(d.message)}catch{i.error(data.message)}}).catch(p=>{console.log("Validate Failed:",p)})};return u("div",{children:[e(y,{type:"link",onClick:()=>a(),children:"編輯"}),e(g,{title:e("div",{className:"mt-2 mb-5 ",children:"編輯代理商"}),open:t,closeIcon:!1,destroyOnClose:!0,onOk:s.submit,onCancel:b,className:"text-center",bodyStyle:{display:"flex",alignItems:"center",justifyContent:"center",height:"60px"},width:470,children:e(m,{form:s,preserve:!1,onFinish:A,name:"basic",initialValues:{remember:!0},autoComplete:"off",children:e(m.Item,{label:"代理商名稱",name:"name",rules:[{required:!0,message:"請輸入代理商名稱"}],colon:!1,children:e(x,{className:"w-50",defaultValue:o})})})})]})};const O=({agentId:c,agentName:r,onGetAgentsData:o})=>{const s=f(),l=async()=>{try{const{data:t}=await s.deleteAgent({id:c});(t==null?void 0:t.status)===!0?(o(),g.destroyAll(),i.success(t.message)):i.error(t.message)}catch{i.error(data.message)}};return e("div",{children:e(y,{type:"link",danger:!0,onClick:()=>{g.confirm({title:e("div",{className:"mt-2 mb-5",children:"刪除代理商"}),className:"text-center",bodyStyle:{display:"flex",alignItems:"center",justifyContent:"center",height:"155px"},width:320,icon:null,content:u("div",{children:[u("p",{children:["代理商:",r]}),e("p",{className:"mb-5",children:"您確定要刪除此代理商嗎?"})]}),footer:(t,{OkBtn:n,CancelBtn:a})=>u(I,{children:[e(a,{}),e(y,{type:"primary",onClick:l,children:"確定"})]})})},children:"刪除"})})},j=({agents:c,onGetAgentsData:r})=>{const o=window.innerHeight*.6,s=[{title:"代理商名稱",dataIndex:"name",key:"agents"},{title:"授權數量",dataIndex:"licenseCount",key:"licenseCount"},{title:"IP綁定總數",dataIndex:"licenseIpCount",key:"licenseIpCount"},{title:"操作",dataIndex:"id",key:"id",render:(t,n)=>u(C,{size:"middle",children:[e(w,{to:`/authroizationList/${n.id}`,className:"text-blue-400",children:"授權列表"}),e(E,{onGetAgentsData:r,agentId:n.id,agentName:n.name}),e(O,{onGetAgentsData:r,agentId:n.id,agentName:n.name})]})}],l=`${100/s.length}%`;return s.forEach(t=>{t.width=l}),e("div",{children:e(v,{dataSource:c,columns:s,pagination:!1,scroll:{y:o}})})},H=()=>{const c=f(),[r,o]=h.useState([]),[s,l]=h.useState(!1);h.useEffect(()=>{t()},[]);const t=async()=>{try{const{data:n}=await c.getAllAgents();n.status===!0&&o(n.data.map(a=>({...a,key:a.id})))}catch{i.error("取得代理商列表失敗")}};return u("div",{children:[e(N,{home:!0}),e(F,{addButton:!0,title:"新增代理商",onClick:()=>l(!0)}),e(S,{open:s,onCancel:()=>l(!1),callBack:t}),e(j,{agents:r,onGetAgentsData:t})]})};export{H as default};
